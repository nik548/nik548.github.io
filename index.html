<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>100 Reasons I Love You</title>
  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&family=Dancing+Script:wght@700&display=swap" rel="stylesheet">
  <style>
    * { margin:0; padding:0; box-sizing:border-box; }
    body {
      font-family: 'Poppins', sans-serif;
      display:flex; flex-direction:column;
      justify-content:space-between; align-items:center;
      height:100vh; padding:20px 0;
      background:linear-gradient(180deg,#ffe4e8 0%,#fff0f5 100%);
      position:relative; overflow:hidden;
    }
    @keyframes fadeIn {
      from {opacity:0; transform:translateY(-10px);} 
      to {opacity:1; transform:translateY(0);}
    }
    h1 {
      font-size:32px; font-weight:600; color:#d6336c;
      opacity:0; animation:fadeIn 1.2s ease forwards;
    }

    /* Layout for prev-card-card-fav */
    /* Replace your existing .main-container with: */
    .main-container {
    display: flex;
    justify-content: center;   /* center horizontally */
    align-items: center;       /* center vertically */
    gap: 20px;
    flex: 1;
    }

    .box {
      width:200px; min-height:200px;
      background:#fff; border:2px solid #ffccd5;
      border-radius:12px; padding:15px;
      box-shadow:0 2px 10px rgba(0,0,0,0.1);
      display:flex; flex-direction:column;
      justify-content:center; align-items:center;
      font-size:16px; color:#333;
    }
    .box h2 {
      font-size:18px; margin-bottom:10px; color:#d6336c;
    }

    /* Card styling */
    .card {
      width:300px; height:200px;
      border:4px solid #ffccd5; border-radius:15px;
      box-shadow:0 4px 20px rgba(255,182,193,0.5);
      background:#fff; perspective:1000px; cursor:pointer;
      opacity:0; animation:fadeIn 1.5s ease forwards;
      animation-delay:0.5s;
    }
    .card-inner {
      width:100%; height:100%; position:relative;
      transform-style:preserve-3d;
      transition:transform 0.6s cubic-bezier(0.25,1.5,0.5,1);
    }
    .card.flipped .card-inner { transform:rotateY(180deg); }

    .card-face {
      position:absolute; width:100%; height:100%;
      backface-visibility:hidden; border-radius:11px;
      display:flex; justify-content:center; align-items:center;
      padding:20px;
    }
    .card-front {
      background:#ffccd5; color:#222;
      font-family:'Dancing Script',cursive;
      font-size:24px; font-weight:700; text-align:center;
      line-height:1.2;
    }
    .card-back {
      background:#ffe4e1; transform:rotateY(180deg);
      flex-direction:column; justify-content:flex-start;
      padding-bottom:80px; position:relative;
    }

    #reason-text {
      max-width:240px; text-align:center; margin-top:30px;
      font-size:18px; color:#333;
    }

    /* Heart icon */
    .heart {
      position:absolute; top:12px; right:12px;
      font-size:24px; color:#ccc; cursor:pointer;
      transition:color 0.3s;
    }
    .heart.hearted { color:#e63946; }

    /* Animal unchanged */
    .animal {
      position:absolute; bottom:10px; right:10px;
      width:60px; height:60px;
      animation: dance 1s infinite ease-in-out;
    }
    @keyframes dance {
      0%,100%{transform:translateY(0) rotate(-5deg);}
      50%{transform:translateY(-5px) rotate(5deg);}
    }
    .animal::before { content:''; position:absolute;
      width:60px; height:60px; border-radius:50%;
      background:inherit;
    }
    .animal::after { content:''; position:absolute;
      width:8px; height:8px; background:#000;
      border-radius:50%; top:20px; left:15px;
      box-shadow:20px 0 #000;
    }
    
    /* ---------- CAT ---------- */
    .animal.cat {
    background: #ffcccb;
    }
    .animal.cat .ear {
    position: absolute;
    width: 15px;
    height: 15px;
    background: #ffcccb;
    top: -10px;
    clip-path: polygon(50% 0%, 0% 100%, 100% 100%);
    }
    .animal.cat .ear.left  { left: 5px; }
    .animal.cat .ear.right { right: 5px; }
    .animal.cat .whiskers {
    position: absolute;
    bottom: 15px;
    width: 40px;
    height: 2px;
    }
    .animal.cat .whiskers::before,
    .animal.cat .whiskers::after {
    content: '';
    position: absolute;
    width: 40px;
    height: 2px;
    background: #000;
    }
    .animal.cat .whiskers::before { transform: rotate(10deg); }
    .animal.cat .whiskers::after  { transform: rotate(-10deg); }

    /* ---------- BUNNY ---------- */
    .animal.bunny {
    background: #f4f4f4;
    }
    .animal.bunny .ear {
    position: absolute;
    width: 12px;
    height: 30px;
    background: #f4f4f4;
    top: -30px;
    border-radius: 50%;
    }
    .animal.bunny .ear.left  { left: 10px; }
    .animal.bunny .ear.right { right: 10px; }
    .animal.bunny .blush {
    position: absolute;
    bottom: 10px;
    left: 8px;
    width: 10px;
    height: 10px;
    border-radius: 50%;
    background: pink;
    box-shadow: 34px 0 pink;
    }

    /* ---------- BEAR ---------- */
    .animal.bear {
    background: #deb887;
    }
    .animal.bear .ear {
    position: absolute;
    width: 14px;
    height: 14px;
    background: #deb887;
    border-radius: 50%;
    top: -8px;
    }
    .animal.bear .ear.left  { left: 8px; }
    .animal.bear .ear.right { right: 8px; }
    .animal.bear .nose {
    position: absolute;
    top: 30px;
    left: 26px;
    width: 10px;
    height: 8px;
    border-radius: 50%;
    background: #333;
    }

    #countdown {
      font-size:20px; color:#444;
      background:rgba(255,255,255,0.9);
      padding:8px 12px; border-radius:8px;
      margin-top:20px;
    }
  </style>
</head>
<body>
  <h1>100 Reasons I Love You</h1>

  <div class="main-container">
    <!-- Previous Reason Box -->
    <div class="box" id="prev-box">
      <h2>Previous</h2>
      <div id="prev-reason">—</div>
    </div>

    <!-- Flip Card -->
    <div class="card" id="card">
      <div class="card-inner">
        <div class="card-face card-front" id="card-front">
          Click here for today’s reason
        </div>
        <div class="card-face card-back" id="card-back">
          <div class="heart" id="heart">❤</div>
          <div id="reason-text"></div>
          <div id="animal" class="animal"></div>
        </div>
      </div>
    </div>

    <!-- Favorite Reason Box -->
    <div class="box" id="fav-box">
      <h2>Favorite</h2>
      <div id="fav-reason">—</div>
    </div>
  </div>

  <div id="countdown"></div>

  <script>
    // List of reasons (fill to 100)
    const reasons = [
      "You always make me laugh.", "You’re my biggest supporter.",
      "I love how you scrunch your nose when you smile.",
      "You make even ordinary days special.",
      "You believe in me when I doubt myself.",
      // ...continue to 100
    ];

    // Shuffle helper
    function shuffle(a) {
      for (let i = a.length-1; i>0; i--) {
        const j = Math.floor(Math.random()*(i+1));
        [a[i], a[j]] = [a[j], a[i]];
      }
      return a;
    }

    let list = shuffle([...reasons]), idx = 0;
    function nextReason(){
      if(idx >= list.length) {
        list = shuffle([...reasons]); idx = 0;
      }
      return list[idx++];
    }

    // Compute reset at 7am EST
    function getNextReset(){
      const now = new Date(),
            off = now.getTimezoneOffset() + 5*60,
            nowEst = new Date(now.getTime()+off*60000);
      let reset = new Date(nowEst);
      reset.setHours(7,0,0,0);
      if(nowEst >= reset) reset.setDate(reset.getDate()+1);
      return new Date(reset.getTime() - off*60000 - now.getTimezoneOffset()*60000);
    }
    const nextReset = getNextReset();

    // Countdown update
    function updateCountdown(){
      const diff = nextReset - new Date();
      if(diff <=0) return location.reload();
      const h = String(Math.floor(diff/3600000)).padStart(2,'0'),
            m = String(Math.floor((diff%3600000)/60000)).padStart(2,'0'),
            s = String(Math.floor((diff%60000)/1000)).padStart(2,'0');
      document.getElementById('countdown').innerText =
        `Countdown to next card: ${h}:${m}:${s}`;
    }
    setInterval(updateCountdown,1000); updateCountdown();

    // Load stored reasons
    let stored = localStorage.getItem('todayReason'),
        exp    = localStorage.getItem('expiry'),
        prev   = localStorage.getItem('prevReason'),
        fav    = localStorage.getItem('favoriteReason'),
        isValid= stored && new Date(exp)>new Date();

    let today = isValid ? stored : nextReason();

    // If a new day, shift previous
    if(!isValid){
      if(stored) localStorage.setItem('prevReason', stored);
      prev = stored || '—';
      localStorage.setItem('todayReason', today);
      localStorage.setItem('expiry', nextReset);
    }

    document.getElementById('prev-reason').innerText = prev || '—';
    document.getElementById('fav-reason').innerText = fav || '—';

    // Update back content
    function updateBack(){
      document.getElementById('reason-text').innerText = today;
      const a = ['cat','bunny','bear'][Math.floor(Math.random()*3)],
            el = document.getElementById('animal');
      el.className = `animal ${a}`;
      el.innerHTML = `
        <div class="ear left"></div><div class="ear right"></div>
        ${a==='cat'?'<div class="whiskers"></div>':''}
        ${a==='bunny'?'<div class="blush"></div>':''}
        ${a==='bear'?'<div class="nose"></div>':''}
      `;
      // Heart highlight if today's is favorite
      const heart = document.getElementById('heart');
      if(fav === today) heart.classList.add('hearted');
      else heart.classList.remove('hearted');
    }
    updateBack();

    // Heart click → favorite
    document.getElementById('heart').addEventListener('click', e => {
      e.stopPropagation();
      fav = today;
      localStorage.setItem('favoriteReason', fav);
      document.getElementById('fav-reason').innerText = fav;
      document.getElementById('heart').classList.add('hearted');
    });

    // Flip card on click
    document.getElementById('card').addEventListener('click', ()=>{
      document.getElementById('card').classList.toggle('flipped');
    });
  </script>
</body>
</html>
